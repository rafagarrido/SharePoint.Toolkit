function normalizarFecha(fechaSharePoint) {
    if (!fechaSharePoint) return null;

    // Si ya es un objeto Date v√°lido
    if (Object.prototype.toString.call(fechaSharePoint) === "[object Date]") {
        if (!isNaN(fechaSharePoint.getTime())) {
            return fechaSharePoint.toISOString();
        }
    }

    // Si es string en formato dd-mm-yyyy (o dd/mm/yyyy)
    const regexDMY = /^(\d{2})[-\/](\d{2})[-\/](\d{4})$/;
    const match = fechaSharePoint.match(regexDMY);

    if (match) {
        const [ , dd, mm, yyyy ] = match;
        const fechaISO = new Date(`${yyyy}-${mm}-${dd}T00:00:00`);
        return isNaN(fechaISO.getTime()) ? null : fechaISO.toISOString();
    }

    // Si es cualquier otro formato legible por Date()
    const fecha = new Date(fechaSharePoint);
    return isNaN(fecha.getTime()) ? null : fecha.toISOString();
}